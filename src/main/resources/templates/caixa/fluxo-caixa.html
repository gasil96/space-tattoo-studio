<!DOCTYPE html>
<html layout:decorate="~{layout-principal}">
<head>
<meta charset="UTF-8" />
<body>
	<h2 layout:fragment="titulosubCabecalho">Controle Caixa Diário</h2>

	<li layout:fragment="caminho">Caixa</li>

	<div layout:fragment="corpo">

		<section class="no-padding-bottom">
			<div class="container-fluid">
				<div class="row">
					<div class="col-lg-12">
						<div class="stats-2-block block d-flex">
							<div class="stats-2 d-flex">
								<div class="stats-2-arrow height">
									<i class="fa fa-caret-up"></i>
								</div>
								<div class="stats-2-content">
									<strong class="d-block">R$ <strong>3145.00</strong></strong><span
										class="d-block">Saldo Atual</span>
									<div class="progress progress-template progress-small">
										<div role="progressbar" style="width: 60%;" aria-valuenow="30"
											aria-valuemin="0" aria-valuemax="100"
											class="progress-bar progress-bar-template progress-bar-small dashbg-2"></div>
									</div>
								</div>
							</div>
							<div class="stats-2 d-flex">
								<div class="stats-2-arrow height">
									<i class="fa fa-caret-up"></i>
								</div>
								<div class="stats-2-content">
									<strong class="d-block">R$ <strong>2387.00</strong></strong><span
										class="d-block">Entrada</span>
									<div class="progress progress-template progress-small">
										<div role="progressbar" style="width: 35%;" aria-valuenow="30"
											aria-valuemin="0" aria-valuemax="100"
											class="progress-bar progress-bar-template progress-bar-small dashbg-3"></div>
									</div>
								</div>
							</div>
							<div class="stats-2 d-flex">
								<div class="stats-2-arrow low">
									<i class="fa fa-caret-down"></i>
								</div>
								<div class="stats-2-content">
									<strong class="d-block">R$ <strong>758.00</strong></strong><span
										class="d-block">Saída</span>
									<div class="progress progress-template progress-small">
										<div role="progressbar" style="width: 35%;" aria-valuenow="30"
											aria-valuemin="0" aria-valuemax="100"
											class="progress-bar progress-bar-template progress-bar-small dashbg-3"></div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<section>
			<div class="col-lg-12">
				<div class="block">
					<div class="block-body">
						<div id="abrir-caixa">
							<form class="form-inline"
								th:action="@{/caixa/abrir-fechar-caixa}"
								th:object="${entradaSaida}" method="POST" id="formAbrirCaixa">
								<div class="form-group" style="margin-right: 10px">
									<label for="inlineFormInput" class="sr-only">Valor
										Inicial Caixa</label> <input type="text" value="0"
										class="form-control" th:field="*{valor}" required="required"
										placeholder="Valor inicial">
								</div>
								<div class="form-group">
									<input type="submit" value="ABRIR CAIXA"
										class="btn btn-primary" id="abrir-caixa">


								</div>
							</form>
						</div>
						<div id="fechar-caixa">
							<form class="form-inline" th:action="@{/caixa/fechar-caixa}"
								th:object="${caixa}" method="POST">
								<div class="form-group">
									<input type="submit" value="FECHAR CAIXA"
										class="btn btn-danger">
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</section>

		<section id="fluxo" style="display: block;">
			<div class="col-lg-8">
				<div class="block">
					<div class="title" align="center">
						<strong>CAIXA ABERTO</strong> <i class="material-icons"
							style="color: green"> monetization_on </i>
					</div>
					<div class="block-body">
						<form th:action="@{/caixa/adicionar}" th:object="${entradaSaida}"
							method="POST">
							<div class="form-group">
								<div class="i-checks" align="center">
									<input th:each="to : ${tipooperacao}" th:value=${to}
										name="radios" class="radio-template" required="required"
										type="radio" th:text="${to.operacao}" style="margin: 6px"
										th:field="*{tipoOperacao}">
								</div>
							</div>
							<div id="esconderForm">
								<div class="form-group" id="tipoEntrada">
									<label for="categoriaEntrada">Tipo de Entrada</label> <select
										id="categoriaEntrada" class="form-control" required="required"
										th:field="*{categoriaEntrada}">
										<option th:each="cat : ${categoriaentrada}" th:value="${cat}"
											th:text="${cat.categoriaEntrada}">ATIVO</option>
									</select>
								</div>
								<div class="form-group">
									<label>Descrição</label> <input type="text" id="descricao"
										placeholder="Informações sobre..." class="form-control"
										required="required" th:field="*{descricao}">
								</div>
								<div class="form-group">
									<label>Valor R$</label> <input type="text" value="0"
										class="form-control" th:field="*{valor}" required="required">
								</div>
								<div class="form-group" id="desconto">
									<label>Desconto % <span
										style="font-size: 11px; vertical-align: top; color: white">(
											Opcional )</span></label> <input type="text" value="0" class="form-control"
										th:field="*{desconto}">
								</div>
								<div class="form-group" id="formaPagamento">
									<label for="formaPagamento">Forma de pagamento</label> <select
										id="formaPagamento" class="form-control" required="required"
										th:field="*{formaPagamento}">
										<option value="" selected="selected">Selecione...</option>
										<option th:each="fp : ${formapagamento}" th:value="${fp}"
											th:text="${fp.pagamento}">ATIVO</option>
									</select>
								</div>
								<div align="right">
									<button type="reset" class="btn btn-warning">Limpar</button>
									<button type="submit" class="btn btn-primary">Adicionar</button>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
		</section>
		<section class="no-padding-top">
			<div class="container-fluid">
				<div class="block">
					<div class="title">
						<strong>Fluxo de Caixa Atual ( <span id="diaAs"> </span> )</strong>
					</div>
					<div class="block-body">
						<div class="table-responsive">
							<table id="dataTableFluxo" style="width: 100%;" class="table">
								<thead>
									<tr>
										<th>Tipo</th>
										<th>Horario</th>
										<th>Segmento</th>
										<th>Descrição</th>
										<th>Valor</th>
										<th>Pagamento</th>
										<th>Desconto</th>
										<th>-</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>SAÍDA</td>
										<td>12:53</td>
										<td>Dirversos</td>
										<td>Pagamento Energia</td>
										<td>R$ <span>253</span></td>
										<td>À Vista</td>
										<td><span>0</span>%</td>
										<td><a role="button"> <span title="EDITAR"
												aria-hidden="true" style="color: grey;"><i
													class="material-icons">style</i></span>
										</a> <a role="button"> <span title="AGENDAR"
												style="color: white" onmouseover="iconOnOver(this)"
												onmouseout="iconNormal(this)"><i
													class="material-icons">note_add</i></span>
										</a></td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</section>

	</div>
	<script type="text/javascript" layout:fragment="script">
		//  TODO - PROVISORIO INICIALIZAR --> "STYLE DISPLAY NONE" BUTTON FECHAR CAIXA E FORM  @@@@@@@@@@@@@2

		var hojeAs = moment().calendar();
		
		$("#diaAs").append("<strong>"+hojeAs+"</strong>");
		
		$(document).ready(function() {
			$("#esconderForm").hide();
			$('input:radio[name="tipoOperacao"]').change(function() {
				if ($("input[name='tipoOperacao']:checked")) {
					controleFormulario($(this).val());
				} else {
					alert("Erro, contate o suporte");
				}
			});

			// 			@@@@@@ INICIO TODO - QUEM VAI DEFIRNIR A VISIBILIDADE DOS BUTTONS SERA O TH:IF() OU TH:UNLESS @@@@@@@@@@@@@@@@@@@@

			$("#fechar-caixa").hide();
			$("#abrir-caixa").show();
			// 			@@@@@@ FIM TODO -  @@@@@@@@@@@@@@@@@@@@

		});

		function controleFormulario(e) {
			if (e == 'ENTRADA') {
				$("#esconderForm").show();
				$("#desconto").show();
			} else if (e == 'SAIDA') {
				$("#esconderForm").show();
				$("#desconto").hide();
			} else {
				alert("Erro, contate o suporte");
			}
		}

		$("input[name='valor']").TouchSpin({
			min : 0,
			max : 1000000000000000000000000000,
			step : 10.0,
			decimals : 2,
			boostat : 5,
			maxboostedstep : 10,
			prefix : 'R$',
		});

		$("input[name='desconto']").TouchSpin({
			min : 0,
			max : 100,
			step : 5,
			boostat : 5,
			maxboostedstep : 10,
			prefix : '%',
		});

		$(document)
				.ready(
						function() {
							
							var diaAtual = moment().format('Do MMMM YYYY');
							
							$('#dataTableFluxo')
									.DataTable(
											{
												dom : 'lBfrtip',
												order : [],
												buttons : [
														{
															extend : 'pdf',
															className : 'btn btn-primary btn-sm',
															title : 'Fluxo Caixa '+diaAtual,
															exportOptions : {
																columns : ':visible'
															},
														},
														{
															extend : 'excel',
															text : 'Planilha',
															title : 'Fluxo Caixa '+diaAtual,
															className : 'btn btn-primary btn-sm',
															exportOptions : {
																columns : ':visible'
															},
														},
														{
															extend : 'print',
															className : 'btn btn-primary btn-sm',
															text : 'Impressão',
															title : 'Fluxo Caixa '+diaAtual,
															exportOptions : {
																columns : ':visible'
															},
														} ],
												language : {
													"url" : "//cdn.datatables.net/plug-ins/1.10.19/i18n/Portuguese-Brasil.json"
												}
											});
						});
	</script>

</body>
</html>